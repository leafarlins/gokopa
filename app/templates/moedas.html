{% extends "base.html" %}
{% block content %}

<div class="texto">
  <h2 class="center">Moedas</h2>
  <p>Aqui voc√™ pode gerenciar suas moedas de investimentos em seus times favoritos. Diariamente, escolha um clube para tentar ser o patrocinador. Quem der o valor mais alto ao final do dia vira patrocinador do time at√© sua desclassifica√ß√£o.</p>
  <p>A cada dia de competi√ß√£o, derrotas dos times patrocinados poder√£o perder moedas (em investimento), vit√≥rias poder√£o adicionar moedas no saldo. Ser√£o debitados inicialmente 30 moedas caso o jogador tenha saldo fora de uso, e o jogador ganhar√° moedas extras de acordo com seu desempenho no bol√£o.</p>
</div>

<div class="row scool-pane">
<div class="col-12 col-sm-12 col-md-12 col-lg-4 col-xl-4">
    <hr>
    <h2>√Årea do jogador</h2>
    <div class="sectionj">
        {% with messages = get_flashed_messages(with_categories=true) %} {% if messages %} {% for category, message in messages %}
          <div class="alert alert-{{ category }}" role="alert">
              {{ message }}
          </div>
        {% endfor %} {% endif %} {% endwith %}
        {% if info["userlogado"] %}
        <table class="tab_gokopa tab_jogos">
            <tr>
                <td>Saldo de Moedas</td>
            </tr>
            <tr>
                <td>{{ user_info['saldo'] }} ü™ô</td>
            </tr>
        </table>

        {% if user_info["lista_livre"] %}
        <p>&nbsp;</p><p>Tentativa de patroc√≠nio</p>
        <form action="{{ url_for('moedas.addpat') }}" method="post">
            <div class="form-row">
                <div class="form-group col-md-6"><label for="time1">Selecione um time:</label>
                    <input type="hidden" name="timename" value="" id="timename">
                    <select list="times" name="time1" id="time1" onchange="update_minimo()">
                        {% for i in user_info["lista_livre"] %}
                          <option value="{{ i['Valor'] }}" label="{{ i['Time'] }}">{{ i['Time'] }}</option>
                        {% endfor %}
                    </select></div>
                <div class="form-group col-md-6"><label for="valor_pat">Valor:</label>
                  <input style="max-width: 80%" type="number" name="valor_pat" id="valor_pat" width="10px" value="0" min="0" max="{{ user_info['saldo'] }}"></div>
            </div>
            <button type="submit" class="btn btn-outline-primary">Tentar investimento</button>
        </form>
        {% endif %}

        {% if user_info['tentarpat'] %}
        <p>&nbsp;</p><p>Tentativas enviadas</p>
        <ul class="list-group">
          {% for item in user_info['tentarpat'] %}
            <li class="list-group-item">ü™ô {{ item['valor'] }} <img class="flag" src="../static/img/flag/{{ item['time'] }}.png" onerror="this.src='../static/img/flag/default.png'"> {{ item['time'] }} <button type="button" class="btn btn-outline-danger btn-sm">X</button></li>
          {% endfor %}
        </ul>
        {% endif %}


        <script type="text/javascript">
            function update_minimo() {
                var select = document.getElementById('time1');
                var option = select.options[select.selectedIndex];
        
                document.getElementById('valor_pat').value = option.value;
                document.getElementById('valor_pat').min = option.value;
                document.getElementById('timename').value = option.label;
            }
        
            update_minimo();
        </script>

        {% else %}
        <p>Voc√™ n√£o est√° logado ou n√£o tem acesso ao jogo de moedas.</p>
        {% endif %}
    </div>

    <hr>
</div>


<div class="col-12 col-sm-12 col-md-12 col-lg-8 col-xl-8">
    <h2>Patroc√≠nios e apoios</h2>
</div>

</div>

<div class="row scoll-pane">
    <div class="col-12 col-sm-12 col-md-6 col-lg-6 col-xl-4">
        <h3>Resultado geral</h3>
        <table class="tab_gokopa">
            <tr>
                <th title="Posi√ß√£o">#</th>
                <th style="min-width: 100px;">Nome</th>
                <th style="min-width: 50px;">Total</th>
                <th title="Investimento" style="min-width: 50px;">Inv.</th>
                <th title="Saldo" style="min-width: 50px;">Saldo</th>
            </tr>
            {% for item in info['moedas_board'] %}
            <tr>
                <td>{{ item['pos'] }}</td>
                <td>{{ item['nome'] }}</td>
                <td>{{ item['total'] }} ü™ô</td>
                <td>{{ item['investido'] }} ü™ô</td>
                <td>{{ item['saldo'] }} ü™ô</td>
            </tr>
            {% endfor %}
        </table>
    </div>
    <div class="col-12 col-sm-12 col-md-6 col-lg-6 col-xl-4 smallt center">
        <h3>Jogos pr√≥ximos</h3>
        {% if info['jogos'] %}
        <ul class="list-group">
          {% for j in info['jogos'] %}
            <li class="list-group-item">({{ j['time1_valor'] }}ü™ô) {{ j['time1'] }} <img class="flag" src="../static/img/flag/{{ j['time1'] }}.png" onerror="this.src='../static/img/flag/default.png'"> x <img class="flag" src="../static/img/flag/{{ j['time2'] }}.png" onerror="this.src='../static/img/flag/default.png'"> {{ j['time2'] }} ({{ j['time2_valor'] }}ü™ô)<br>
            {{ j['moedas_em_jogo'] }}ü™ô em jogo</li>
          {% endfor %}
        </ul>
        {% else %}
        <p>Sem jogos para exibir.</p>
        {% endif %}
    </div>
    <div class="col-12 col-sm-12 col-md-12 col-lg-12 col-xl-4 smallt center">
        <h3>Logs de moedas</h3>
        <table class="tab_gokopa smallt">
            <tr>
                <th title="LogId">Data</th>
                <th style="min-width: 20px;">Nome</th>
                <th style="min-width: 20px;">Time</th>
                <th style="min-width: 20px;">ü™ô</th>
                <th style="min-width: 100px;">Descri√ß√£o</th>
            </tr>
            {% for l in info['logs'] %}
            <tr>
                <td title="{{ l['lid'] }}">{{ l['data'] }}</td>
                <td>{% if info['username'] == l['nome'] %}<b>{{ l['nome'] }}</b>{% else %}{{ l['nome'] }}{% endif %}</td>
                <td><img class="flag" src="../static/img/flag/{{ l['time'] }}.png" onerror="this.src='../static/img/flag/default.png'"></td>
                <td>{{ l['moedas'] }}</td>
                <td style="text-align: left;">{{ l['msg'] }}</td>
            </tr>
            {% endfor %}
        </table>
    </div>
</div>

{% endblock %}